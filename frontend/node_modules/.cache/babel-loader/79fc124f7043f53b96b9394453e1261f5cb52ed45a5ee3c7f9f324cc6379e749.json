{"ast":null,"code":"import _slicedToArray from\"C:/Users/rashm/OneDrive/Documents/IMP/nbad/final proj/NBAD/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{BrowserRouter as Router,Routes,Route,useNavigate}from\"react-router-dom\";import\"./App.scss\";import Hero from\"./Hero/Hero\";import HomePage from\"./HomePage/HomePage\";import Menu from\"./Menu/Menu\";import LoginPage from\"./LoginPage/LoginPage\";import{AuthProvider}from\"./AuthContext\";import Dashboard from\"./Dashboard/Dashboard\";import ConfigureBudgets from\"./ConfigureBudgets/ConfigureBudgets\";import ManageExpense from\"./ConfigureBudgets/ManageExpense\";import Visuals from\"./ConfigureBudgets/visuals\";import{useEffect,useRef,useState}from\"react\";import TokenExpirationPopup from\"./TokenExpiration\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showPopup=_useState2[0],setShowPopup=_useState2[1];var intervalIdRef=useRef(null);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoggedIn=_useState4[0],setIsLoggedIn=_useState4[1];useEffect(function(){var isLogdIn=localStorage.getItem('isLoggedIn')==='true';console.log(\"CHECK\",isLogdIn);if(isLogdIn){var storedExpirationTime=parseInt(localStorage.getItem('expirationTime'),10);if(storedExpirationTime&&storedExpirationTime>Date.now()){intervalIdRef.current=setInterval(function(){console.log(\"CHEDKING\",storedExpirationTime,Date.now());var remainingTime=storedExpirationTime-Date.now();if(remainingTime<=0){handleLogout();}else if(remainingTime<=20000){setShowPopup(true);}},1000);}}return function(){return clearInterval(intervalIdRef.current);};},[isLoggedIn]);var handleRefresh=function handleRefresh(){var newExpirationTime=Date.now()+60000;setShowPopup(false);localStorage.setItem('expirationTime',newExpirationTime.toString());var userId=localStorage.getItem('userId');clearInterval(intervalIdRef.current);var newIntervalId=setInterval(function(){console.log(\"CHEDKING222\",newExpirationTime,Date.now());var remainingTime=newExpirationTime-Date.now();axios.post(\"http://18.189.44.29:3002/refresh-token/\".concat(userId)).then(function(res){var newtoken=res.data.token;console.log(newtoken);localStorage.setItem('token',newtoken);});if(remainingTime<=0){handleLogout();}else if(remainingTime<=20000){setShowPopup(true);}},1000);intervalIdRef.current=newIntervalId;};var handleLogout=function handleLogout(){localStorage.removeItem('isLoggedIn');localStorage.removeItem('expirationTime');localStorage.removeItem('token');localStorage.removeItem('userId');window.location.href='/login';};var setLoggedIn=function setLoggedIn(flag){setIsLoggedIn(flag);};return/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(Hero,{}),/*#__PURE__*/_jsx(\"div\",{className:\"mainContainer\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(Dashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LoginPage,{callBack:setLoggedIn})}),/*#__PURE__*/_jsx(Route,{path:\"/configure-budgets\",element:/*#__PURE__*/_jsx(ConfigureBudgets,{})}),/*#__PURE__*/_jsx(Route,{path:\"/add-expense\",element:/*#__PURE__*/_jsx(ManageExpense,{})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/Visual\",element:/*#__PURE__*/_jsx(Visuals,{})})]})}),showPopup&&/*#__PURE__*/_jsx(TokenExpirationPopup,{onRefresh:handleRefresh,onClose:handleLogout})]})});}export default App;","map":{"version":3,"names":["BrowserRouter","Router","Routes","Route","useNavigate","Hero","HomePage","Menu","LoginPage","AuthProvider","Dashboard","ConfigureBudgets","ManageExpense","Visuals","useEffect","useRef","useState","TokenExpirationPopup","axios","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","showPopup","setShowPopup","intervalIdRef","_useState3","_useState4","isLoggedIn","setIsLoggedIn","isLogdIn","localStorage","getItem","console","log","storedExpirationTime","parseInt","Date","now","current","setInterval","remainingTime","handleLogout","clearInterval","handleRefresh","newExpirationTime","setItem","toString","userId","newIntervalId","post","concat","then","res","newtoken","data","token","removeItem","window","location","href","setLoggedIn","flag","children","className","path","element","callBack","onRefresh","onClose"],"sources":["C:/Users/rashm/OneDrive/Documents/IMP/nbad/final proj/NBAD/frontend/src/App.js"],"sourcesContent":["import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\r\nimport \"./App.scss\";\r\nimport Hero from \"./Hero/Hero\";\r\nimport HomePage from \"./HomePage/HomePage\";\r\nimport Menu from \"./Menu/Menu\";\r\nimport LoginPage from \"./LoginPage/LoginPage\";\r\nimport { AuthProvider } from \"./AuthContext\";\r\nimport Dashboard from \"./Dashboard/Dashboard\";\r\nimport ConfigureBudgets from \"./ConfigureBudgets/ConfigureBudgets\";\r\nimport ManageExpense from \"./ConfigureBudgets/ManageExpense\";\r\nimport Visuals from \"./ConfigureBudgets/visuals\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport TokenExpirationPopup from \"./TokenExpiration\";\r\nimport axios from \"axios\";\r\nfunction App() {\r\n  const [showPopup, setShowPopup] = useState(false);\r\n  const intervalIdRef = useRef(null);\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n  \r\n\r\n\r\nuseEffect(() => {\r\n  const isLogdIn = localStorage.getItem('isLoggedIn') === 'true';\r\n  console.log(\"CHECK\", isLogdIn);\r\n  if (isLogdIn) {\r\n    const storedExpirationTime = parseInt(localStorage.getItem('expirationTime'), 10);\r\n    if (storedExpirationTime && storedExpirationTime > Date.now()) {\r\n\r\n      intervalIdRef.current = setInterval(() => {\r\n        console.log(\"CHEDKING\", storedExpirationTime, Date.now());\r\n        const remainingTime = storedExpirationTime - Date.now();\r\n        \r\n        if (remainingTime <= 0) {\r\n         \r\n          handleLogout();\r\n        } else if (remainingTime <= 20000) {\r\n         \r\n          setShowPopup(true);\r\n        }\r\n      }, 1000); \r\n    }\r\n  }\r\n\r\n  return () => clearInterval(intervalIdRef.current);\r\n}, [isLoggedIn]);\r\n\r\n\r\n\r\nconst handleRefresh = () => {\r\n\r\n  const newExpirationTime = Date.now() + 60000; \r\n  setShowPopup(false);\r\n\r\n \r\n  localStorage.setItem('expirationTime', newExpirationTime.toString());\r\n  const userId=localStorage.getItem('userId')\r\n  \r\n \r\n  clearInterval(intervalIdRef.current);\r\n  const newIntervalId = setInterval(() => {\r\n    console.log(\"CHEDKING222\", newExpirationTime, Date.now());\r\n    const remainingTime = newExpirationTime - Date.now();\r\n   \r\n    axios.post(`http://18.189.44.29:3002/refresh-token/${userId}`)\r\n    .then((res)=>{\r\n      const newtoken=res.data.token\r\n      console.log(newtoken)\r\n      localStorage.setItem('token',newtoken)\r\n    })\r\n    if (remainingTime <= 0) {\r\n     \r\n      handleLogout();\r\n    } else if (remainingTime <= 20000) {\r\n      \r\n      setShowPopup(true);\r\n    }\r\n  }, 1000); \r\n  intervalIdRef.current = newIntervalId;\r\n};\r\n\r\nconst handleLogout = () => {\r\n  \r\n  localStorage.removeItem('isLoggedIn');\r\n  localStorage.removeItem('expirationTime');\r\n  localStorage.removeItem('token')\r\n  localStorage.removeItem('userId')\r\n\r\n  window.location.href = '/login'\r\n};\r\n\r\nconst setLoggedIn = (flag) => {\r\n  setIsLoggedIn(flag);\r\n}\r\n\r\n\r\n  return (\r\n    <AuthProvider>\r\n      <Router>\r\n        {/* <Menu  /> */}\r\n        <Hero />\r\n        <div className=\"mainContainer\">\r\n          <Routes>\r\n            <Route path=\"/dashboard\" element={<Dashboard />} />\r\n            <Route path=\"/\" element={<LoginPage callBack={setLoggedIn} />} />\r\n            <Route path=\"/configure-budgets\" element={<ConfigureBudgets />} />\r\n            <Route path=\"/add-expense\" element={<ManageExpense />} />\r\n            <Route path=\"/home\" element={<HomePage/>} />\r\n            <Route path=\"/Visual\" element={<Visuals />} />\r\n          </Routes>\r\n        </div>\r\n        {showPopup && (\r\n          <TokenExpirationPopup\r\n            onRefresh={handleRefresh}\r\n            onClose={handleLogout}\r\n          />\r\n        )}\r\n      </Router>\r\n    </AuthProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}